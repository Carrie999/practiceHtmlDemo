<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>requestAnimationFrame </title>
</head>
<body>
  <div id="myDiv" style="background-color: lightblue;width: 0;height: 20px;line-height: 20px;">0%</div>
  <button id="btn">run</button>
  <script>
  // var timer;
  // btn.onclick = function(){
  //     clearInterval(timer);
  //     myDiv.style.width = '0';
  //     timer = setInterval(function(){
  //         if(parseInt(myDiv.style.width) < 500){
  //             myDiv.style.width = parseInt(myDiv.style.width) + 5 + 'px';
  //             myDiv.innerHTML =     parseInt(myDiv.style.width)/5 + '%';    
  //         }else{
  //             clearInterval(timer);
  //         }        
  //     },16);
  // }
  // var timer;
  // btn.onclick = function(){
  //     clearTimeout(timer);
  //     myDiv.style.width = '0';
  //     timer = setTimeout(function fn(){
  //         if(parseInt(myDiv.style.width) < 500){
  //             myDiv.style.width = parseInt(myDiv.style.width) + 5 + 'px';
  //             myDiv.innerHTML =     parseInt(myDiv.style.width)/5 + '%';
  //             timer = setTimeout(fn,16);
  //         }else{
  //             clearTimeout(timer);
  //         }    
  //     },0);
  // }
var timer;
btn.onclick = function(){
    myDiv.style.width = '0';
    // cancelAnimationFrame(timer);
    timer = requestAnimationFrame(function fn(){
        if(parseInt(myDiv.style.width) < 500){
            myDiv.style.width = parseInt(myDiv.style.width) + 5 + 'px';
            myDiv.innerHTML =     parseInt(myDiv.style.width)/5 + '%';
            timer = requestAnimationFrame(fn);
        }else{
            cancelAnimationFrame(timer);
        }    
    });
}
</script>
</script>
  </script>
</body>
</html>